\hypertarget{classqsbd_1_1gk}{}\doxysection{qsbd\+::gk$<$ T $>$ Class Template Reference}
\label{classqsbd_1_1gk}\index{qsbd::gk$<$ T $>$@{qsbd::gk$<$ T $>$}}


A class to represent the Greenwald-\/\+Khanna sketch.  


Inheritance diagram for qsbd\+::gk$<$ T $>$\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classqsbd_1_1gk}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classqsbd_1_1gk_ae21cda26d56a9d00f5b435e3a8bb4933}{gk}} (double eps)
\begin{DoxyCompactList}\small\item\em A constructor for the GK summary. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classqsbd_1_1gk_a06c25312da044d3bd88d72811466a879}\label{classqsbd_1_1gk_a06c25312da044d3bd88d72811466a879}} 
\mbox{\hyperlink{classqsbd_1_1gk_a06c25312da044d3bd88d72811466a879}{$\sim$gk}} ()
\begin{DoxyCompactList}\small\item\em The destructor for the GK summary. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classqsbd_1_1gk_a3a1041a9881bf5362a0fb1578022b3e3}{update}} (T value) override
\begin{DoxyCompactList}\small\item\em A method to update the summary. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classqsbd_1_1quantile__sketch}{quantile\+\_\+sketch}}$<$ T $>$ $\ast$ \mbox{\hyperlink{classqsbd_1_1gk_a3223001631ceb911111401bdc7eb3ede}{merge}} (\mbox{\hyperlink{classqsbd_1_1quantile__sketch}{quantile\+\_\+sketch}}$<$ T $>$ \&rhs) override
\begin{DoxyCompactList}\small\item\em Merges this instance of gk with another gk instance. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classqsbd_1_1gk_a039ced5336b543060bf3ee4a5a4999fc}{inner\+\_\+merge}} (\mbox{\hyperlink{classqsbd_1_1quantile__sketch}{quantile\+\_\+sketch}}$<$ T $>$ \&rhs) override
\begin{DoxyCompactList}\small\item\em Merges this instance of gk with another gk instance and saves it in this instance. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classqsbd_1_1gk_a34fd256cb9b567896c2dde66ce43f036}{query}} (T value) override
\begin{DoxyCompactList}\small\item\em A method that returns the rank for some element {\ttfamily value}. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classqsbd_1_1gk_a02306ce2e0b7c41c5ef3021f0e3196e0}\label{classqsbd_1_1gk_a02306ce2e0b7c41c5ef3021f0e3196e0}} 
void \mbox{\hyperlink{classqsbd_1_1gk_a02306ce2e0b7c41c5ef3021f0e3196e0}{print}} ()
\begin{DoxyCompactList}\small\item\em A debug method to print the tuple list in the summary on the standard ouput. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{classqsbd_1_1gk_a83684f1daa6d193af84dbebe04529c14}{get\+\_\+N}} ()
\begin{DoxyCompactList}\small\item\em Getter method to pick the total of elements inserted. \end{DoxyCompactList}\item 
uint64\+\_\+t \mbox{\hyperlink{classqsbd_1_1gk_a1ae807440b4ed82487bf89f7c91042f8}{get\+\_\+heap\+\_\+size}} () override
\begin{DoxyCompactList}\small\item\em Getter for the estimated amount of heap memory allocated for this object for a pointer. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\subsubsection*{template$<$class T$>$\newline
class qsbd\+::gk$<$ T $>$}
A class to represent the Greenwald-\/\+Khanna sketch. 

The GK summary provides a compact summary of data drawn from an ordered input domain U. It\textquotesingle{}s a comparison-\/based algorithm, it works on any ordered domain U where comparison operator is defined. But it only accepts insertions of unweighted elements. So here the total number of elements inserted into the summary, N, is the same as the total weight W. This summary can be merged but its size grows after each MERGE.


\begin{DoxyTemplParams}{Template Parameters}
{\em T} & The object type for the gk \\
\hline
\end{DoxyTemplParams}


Definition at line 30 of file gk.\+hpp.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classqsbd_1_1gk_ae21cda26d56a9d00f5b435e3a8bb4933}\label{classqsbd_1_1gk_ae21cda26d56a9d00f5b435e3a8bb4933}} 
\index{qsbd::gk$<$ T $>$@{qsbd::gk$<$ T $>$}!gk@{gk}}
\index{gk@{gk}!qsbd::gk$<$ T $>$@{qsbd::gk$<$ T $>$}}
\doxysubsubsection{\texorpdfstring{gk()}{gk()}}
{\footnotesize\ttfamily template$<$class T $>$ \\
\mbox{\hyperlink{classqsbd_1_1gk}{qsbd\+::gk}}$<$ T $>$\+::\mbox{\hyperlink{classqsbd_1_1gk}{gk}} (\begin{DoxyParamCaption}\item[{double}]{eps }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



A constructor for the GK summary. 


\begin{DoxyParams}{Parameters}
{\em eps} & The error used in the sketch\\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
The object type T should define std::numeric\+\_\+limits$<$T$>$\+::max() 
\end{DoxyNote}


Definition at line 59 of file gk.\+hpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{59                       \{}
\DoxyCodeLine{60             N = 0;}
\DoxyCodeLine{61             epsilon = eps;}
\DoxyCodeLine{62 }
\DoxyCodeLine{63             \mbox{\hyperlink{utils_8h_abd01b471b80c0ef69eb752347fdc662a}{insert\_sorted}}(tuple\_list, std::make\_pair(std::numeric\_limits<T>::max(), std::make\_pair(1, 0)));}
\DoxyCodeLine{64         \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classqsbd_1_1gk_a1ae807440b4ed82487bf89f7c91042f8}\label{classqsbd_1_1gk_a1ae807440b4ed82487bf89f7c91042f8}} 
\index{qsbd::gk$<$ T $>$@{qsbd::gk$<$ T $>$}!get\_heap\_size@{get\_heap\_size}}
\index{get\_heap\_size@{get\_heap\_size}!qsbd::gk$<$ T $>$@{qsbd::gk$<$ T $>$}}
\doxysubsubsection{\texorpdfstring{get\_heap\_size()}{get\_heap\_size()}}
{\footnotesize\ttfamily template$<$class T $>$ \\
uint64\+\_\+t \mbox{\hyperlink{classqsbd_1_1gk}{qsbd\+::gk}}$<$ T $>$\+::get\+\_\+heap\+\_\+size (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Getter for the estimated amount of heap memory allocated for this object for a pointer. 

\begin{DoxyReturn}{Returns}
The estimated memory in bytes. 
\end{DoxyReturn}


Implements \mbox{\hyperlink{classqsbd_1_1quantile__sketch_ae814c5158cd183267ed7029d97355267}{qsbd\+::quantile\+\_\+sketch$<$ T $>$}}.



Definition at line 291 of file gk.\+hpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{291                                           \{}
\DoxyCodeLine{292             uint64\_t gk\_hs = \textcolor{keyword}{sizeof}(\mbox{\hyperlink{classgk}{gk<T>}});}
\DoxyCodeLine{293             uint64\_t tl\_hs = \textcolor{keyword}{sizeof}(std::pair<T, std::pair<int, int>>) * tuple\_list.capacity();}
\DoxyCodeLine{294 }
\DoxyCodeLine{295             \textcolor{keywordflow}{return} gk\_hs + tl\_hs;}
\DoxyCodeLine{296         \}}

\end{DoxyCode}
\mbox{\Hypertarget{classqsbd_1_1gk_a83684f1daa6d193af84dbebe04529c14}\label{classqsbd_1_1gk_a83684f1daa6d193af84dbebe04529c14}} 
\index{qsbd::gk$<$ T $>$@{qsbd::gk$<$ T $>$}!get\_N@{get\_N}}
\index{get\_N@{get\_N}!qsbd::gk$<$ T $>$@{qsbd::gk$<$ T $>$}}
\doxysubsubsection{\texorpdfstring{get\_N()}{get\_N()}}
{\footnotesize\ttfamily template$<$class T $>$ \\
int \mbox{\hyperlink{classqsbd_1_1gk}{qsbd\+::gk}}$<$ T $>$\+::get\+\_\+N (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Getter method to pick the total of elements inserted. 

\begin{DoxyReturn}{Returns}
The total of elements inserted. 
\end{DoxyReturn}


Definition at line 283 of file gk.\+hpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{283                    \{}
\DoxyCodeLine{284             \textcolor{keywordflow}{return} N;}
\DoxyCodeLine{285         \}}

\end{DoxyCode}
\mbox{\Hypertarget{classqsbd_1_1gk_a039ced5336b543060bf3ee4a5a4999fc}\label{classqsbd_1_1gk_a039ced5336b543060bf3ee4a5a4999fc}} 
\index{qsbd::gk$<$ T $>$@{qsbd::gk$<$ T $>$}!inner\_merge@{inner\_merge}}
\index{inner\_merge@{inner\_merge}!qsbd::gk$<$ T $>$@{qsbd::gk$<$ T $>$}}
\doxysubsubsection{\texorpdfstring{inner\_merge()}{inner\_merge()}}
{\footnotesize\ttfamily template$<$class T $>$ \\
void \mbox{\hyperlink{classqsbd_1_1gk}{qsbd\+::gk}}$<$ T $>$\+::inner\+\_\+merge (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classqsbd_1_1quantile__sketch}{quantile\+\_\+sketch}}$<$ T $>$ \&}]{rhs }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Merges this instance of gk with another gk instance and saves it in this instance. 


\begin{DoxyParams}{Parameters}
{\em rhs} & A gk$<$T$>$ instance to be merged \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{classqsbd_1_1gk}{gk}}$<$T$>$::\mbox{\hyperlink{classqsbd_1_1gk_a3223001631ceb911111401bdc7eb3ede}{merge}}(\mbox{\hyperlink{classqsbd_1_1quantile__sketch}{quantile\+\_\+sketch}}$<$T$>$\&) 
\end{DoxySeeAlso}
\begin{DoxyWarning}{Warning}
The error in both instances needs to be the same. The error will be considered as the same if $|this->error - rhs.error| \leq 1e-6$

The \mbox{\hyperlink{classqsbd_1_1quantile__sketch}{quantile\+\_\+sketch}} must be a instance of the gk class 
\end{DoxyWarning}


Implements \mbox{\hyperlink{classqsbd_1_1quantile__sketch_af3458d26f52106a68ab2a65a81eeb0af}{qsbd\+::quantile\+\_\+sketch$<$ T $>$}}.



Definition at line 191 of file gk.\+hpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{191                                                            \{}
\DoxyCodeLine{192             \mbox{\hyperlink{classgk}{gk<T>}}\& rhs\_cv = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classgk}{gk<T>}}\&\textcolor{keyword}{>}(rhs); }
\DoxyCodeLine{193 }
\DoxyCodeLine{194             \mbox{\hyperlink{qsbd__debug_8h_a0966b817b229d48e5ffc7feab19a0be6}{ASSERT}}(rhs\_cv.epsilon -\/ this-\/>epsilon < 1e-\/6);}
\DoxyCodeLine{195 }
\DoxyCodeLine{196             \textcolor{keywordtype}{int} left\_index = 0;}
\DoxyCodeLine{197             \textcolor{keywordtype}{int} right\_index = 0; }
\DoxyCodeLine{198             \textcolor{keywordtype}{int} merged\_N = 0; }
\DoxyCodeLine{199 }
\DoxyCodeLine{200             std::vector<std::pair<T, std::pair<int, int>>> merged\_tuple;}
\DoxyCodeLine{201 }
\DoxyCodeLine{202             \textcolor{keywordflow}{while}(left\_index < tuple\_list.size() and right\_index < rhs\_cv.tuple\_list.size())\{}
\DoxyCodeLine{203                 merged\_N += 1;}
\DoxyCodeLine{204 }
\DoxyCodeLine{205                 \textcolor{keywordflow}{if}(tuple\_list[left\_index].first < rhs\_cv.tuple\_list[right\_index].first)\{}
\DoxyCodeLine{206                     T value = tuple\_list[left\_index].first;}
\DoxyCodeLine{207                     \textcolor{keywordtype}{int} weight = tuple\_list[left\_index].second.first;}
\DoxyCodeLine{208                     \textcolor{keywordtype}{int} uncertainty = tuple\_list[left\_index].second.second + rhs\_cv.tuple\_list[right\_index].second.first + rhs\_cv.tuple\_list[right\_index].second.second -\/ 1; }
\DoxyCodeLine{209                     }
\DoxyCodeLine{210                     \mbox{\hyperlink{utils_8h_abd01b471b80c0ef69eb752347fdc662a}{insert\_sorted}}(merged\_tuple, \{value, \{weight, uncertainty\}\});}
\DoxyCodeLine{211 }
\DoxyCodeLine{212                     left\_index++;}
\DoxyCodeLine{213                 \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{214                     T value = rhs\_cv.tuple\_list[right\_index].first;}
\DoxyCodeLine{215                     \textcolor{keywordtype}{int} weight = rhs\_cv.tuple\_list[right\_index].second.first;}
\DoxyCodeLine{216                     \textcolor{keywordtype}{int} uncertainty = rhs\_cv.tuple\_list[right\_index].second.second + rhs\_cv.tuple\_list[right\_index].second.first + tuple\_list[left\_index].second.second -\/ 1; }
\DoxyCodeLine{217 }
\DoxyCodeLine{218                     \mbox{\hyperlink{utils_8h_abd01b471b80c0ef69eb752347fdc662a}{insert\_sorted}}(merged\_tuple, \{value, \{weight, uncertainty\}\});}
\DoxyCodeLine{219 }
\DoxyCodeLine{220                     right\_index++;}
\DoxyCodeLine{221                 \}}
\DoxyCodeLine{222             \}}
\DoxyCodeLine{223 }
\DoxyCodeLine{224             \textcolor{keywordflow}{while}(left\_index < tuple\_list.size())\{}
\DoxyCodeLine{225                 merged\_N += 1;}
\DoxyCodeLine{226                 \mbox{\hyperlink{utils_8h_abd01b471b80c0ef69eb752347fdc662a}{insert\_sorted}}(merged\_tuple, tuple\_list[left\_index]);}
\DoxyCodeLine{227 }
\DoxyCodeLine{228                 left\_index++;}
\DoxyCodeLine{229             \}}
\DoxyCodeLine{230 }
\DoxyCodeLine{231             \textcolor{keywordflow}{while}(right\_index < rhs\_cv.tuple\_list.size())\{}
\DoxyCodeLine{232                 merged\_N += 1;}
\DoxyCodeLine{233                 \mbox{\hyperlink{utils_8h_abd01b471b80c0ef69eb752347fdc662a}{insert\_sorted}}(merged\_tuple, rhs\_cv.tuple\_list[right\_index]);}
\DoxyCodeLine{234 }
\DoxyCodeLine{235                 right\_index++;}
\DoxyCodeLine{236             \}}
\DoxyCodeLine{237 }
\DoxyCodeLine{238             \textcolor{keywordtype}{int} capacity = (int) ceil(2.0 * epsilon * merged\_N);}
\DoxyCodeLine{239             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0, j = 1; j < merged\_tuple.size(); i++, j++)\{}
\DoxyCodeLine{240                 \textcolor{keywordflow}{if} ((merged\_tuple[i].second.first + merged\_tuple[j].second.first + merged\_tuple[j].second.second) < capacity)\{}
\DoxyCodeLine{241                     merged\_tuple[j].second.first += merged\_tuple[i].second.first;}
\DoxyCodeLine{242 }
\DoxyCodeLine{243                     merged\_tuple.erase(merged\_tuple.begin() + i);}
\DoxyCodeLine{244                 \}}
\DoxyCodeLine{245             \}}
\DoxyCodeLine{246 }
\DoxyCodeLine{247             \textcolor{comment}{//this-\/>tuple\_list.clear();}}
\DoxyCodeLine{248             this-\/>tuple\_list = std::move(merged\_tuple);}
\DoxyCodeLine{249             this-\/>N = merged\_N;}
\DoxyCodeLine{250         \}}

\end{DoxyCode}
\mbox{\Hypertarget{classqsbd_1_1gk_a3223001631ceb911111401bdc7eb3ede}\label{classqsbd_1_1gk_a3223001631ceb911111401bdc7eb3ede}} 
\index{qsbd::gk$<$ T $>$@{qsbd::gk$<$ T $>$}!merge@{merge}}
\index{merge@{merge}!qsbd::gk$<$ T $>$@{qsbd::gk$<$ T $>$}}
\doxysubsubsection{\texorpdfstring{merge()}{merge()}}
{\footnotesize\ttfamily template$<$class T $>$ \\
\mbox{\hyperlink{classqsbd_1_1quantile__sketch}{quantile\+\_\+sketch}}$<$T$>$$\ast$ \mbox{\hyperlink{classqsbd_1_1gk}{qsbd\+::gk}}$<$ T $>$\+::merge (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classqsbd_1_1quantile__sketch}{quantile\+\_\+sketch}}$<$ T $>$ \&}]{rhs }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



Merges this instance of gk with another gk instance. 


\begin{DoxyParams}{Parameters}
{\em rhs} & A gk$<$T$>$ instance to be merged \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A pointer to the new instance of a gk 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{classqsbd_1_1gk}{gk}}$<$T$>$\+::inner\+\_\+merge(\mbox{\hyperlink{classqsbd_1_1quantile__sketch}{quantile\+\_\+sketch}}$<$T$>$\&) 
\end{DoxySeeAlso}
\begin{DoxyWarning}{Warning}
The error in both instance needs to be the same. The error will be considered as the same if $|this->error - rhs.error| \leq 1e-6$

The \mbox{\hyperlink{classqsbd_1_1quantile__sketch}{quantile\+\_\+sketch}} must be a instance of the gk class

Is the user responsabilite of frees the returned pointer 
\end{DoxyWarning}


Implements \mbox{\hyperlink{classqsbd_1_1quantile__sketch_a20950642c0bd2279335f566b1c0170df}{qsbd\+::quantile\+\_\+sketch$<$ T $>$}}.



Definition at line 121 of file gk.\+hpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{121                                                                     \{}
\DoxyCodeLine{122             \mbox{\hyperlink{classgk}{gk<T>}}\& rhs\_cv = \textcolor{keyword}{dynamic\_cast<}\mbox{\hyperlink{classgk}{gk<T>}}\&\textcolor{keyword}{>}(rhs); }
\DoxyCodeLine{123 }
\DoxyCodeLine{124             \mbox{\hyperlink{qsbd__debug_8h_a0966b817b229d48e5ffc7feab19a0be6}{ASSERT}}(rhs\_cv.epsilon -\/ this-\/>epsilon < 1e-\/6);}
\DoxyCodeLine{125 }
\DoxyCodeLine{126             \textcolor{keywordtype}{int} left\_index = 0;}
\DoxyCodeLine{127             \textcolor{keywordtype}{int} right\_index = 0; }
\DoxyCodeLine{128             \mbox{\hyperlink{classgk}{gk<T>}}* merged\_summary = \textcolor{keyword}{new} \mbox{\hyperlink{classgk}{gk<T>}}(epsilon);}
\DoxyCodeLine{129 }
\DoxyCodeLine{130             \textcolor{keywordflow}{while}(left\_index < tuple\_list.size() and right\_index < rhs\_cv.tuple\_list.size())\{}
\DoxyCodeLine{131                 merged\_summary-\/>N += 1;}
\DoxyCodeLine{132 }
\DoxyCodeLine{133                 \textcolor{keywordflow}{if}(tuple\_list[left\_index].first < rhs\_cv.tuple\_list[right\_index].first)\{}
\DoxyCodeLine{134                     T value = tuple\_list[left\_index].first;}
\DoxyCodeLine{135                     \textcolor{keywordtype}{int} weight = tuple\_list[left\_index].second.first;}
\DoxyCodeLine{136                     \textcolor{keywordtype}{int} uncertainty = tuple\_list[left\_index].second.second + rhs\_cv.tuple\_list[right\_index].second.first + rhs\_cv.tuple\_list[right\_index].second.second -\/ 1; }
\DoxyCodeLine{137                     }
\DoxyCodeLine{138                     \mbox{\hyperlink{utils_8h_abd01b471b80c0ef69eb752347fdc662a}{insert\_sorted}}(merged\_summary-\/>tuple\_list, \{value, \{weight, uncertainty\}\});}
\DoxyCodeLine{139 }
\DoxyCodeLine{140                     left\_index++;}
\DoxyCodeLine{141                 \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{142                     T value = rhs\_cv.tuple\_list[right\_index].first;}
\DoxyCodeLine{143                     \textcolor{keywordtype}{int} weight = rhs\_cv.tuple\_list[right\_index].second.first;}
\DoxyCodeLine{144                     \textcolor{keywordtype}{int} uncertainty = rhs\_cv.tuple\_list[right\_index].second.second + rhs\_cv.tuple\_list[right\_index].second.first + tuple\_list[left\_index].second.second -\/ 1; }
\DoxyCodeLine{145 }
\DoxyCodeLine{146                     \mbox{\hyperlink{utils_8h_abd01b471b80c0ef69eb752347fdc662a}{insert\_sorted}}(merged\_summary-\/>tuple\_list, \{value, \{weight, uncertainty\}\});}
\DoxyCodeLine{147 }
\DoxyCodeLine{148                     right\_index++;}
\DoxyCodeLine{149                 \}}
\DoxyCodeLine{150             \}}
\DoxyCodeLine{151 }
\DoxyCodeLine{152             \textcolor{keywordflow}{while}(left\_index < tuple\_list.size())\{}
\DoxyCodeLine{153                 merged\_summary-\/>N += 1;}
\DoxyCodeLine{154                 \mbox{\hyperlink{utils_8h_abd01b471b80c0ef69eb752347fdc662a}{insert\_sorted}}(merged\_summary-\/>tuple\_list, tuple\_list[left\_index]);}
\DoxyCodeLine{155 }
\DoxyCodeLine{156                 left\_index++;}
\DoxyCodeLine{157             \}}
\DoxyCodeLine{158 }
\DoxyCodeLine{159             \textcolor{keywordflow}{while}(right\_index < rhs\_cv.tuple\_list.size())\{}
\DoxyCodeLine{160                 merged\_summary-\/>N += 1;}
\DoxyCodeLine{161                 \mbox{\hyperlink{utils_8h_abd01b471b80c0ef69eb752347fdc662a}{insert\_sorted}}(merged\_summary-\/>tuple\_list, rhs\_cv.tuple\_list[right\_index]);}
\DoxyCodeLine{162 }
\DoxyCodeLine{163                 right\_index++;}
\DoxyCodeLine{164             \}}
\DoxyCodeLine{165 }
\DoxyCodeLine{166             \textcolor{keywordtype}{int} capacity = (int) ceil(2.0 * epsilon * merged\_summary-\/>get\_N());}
\DoxyCodeLine{167             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0, j = 1; j < merged\_summary-\/>tuple\_list.size(); i++, j++)\{}
\DoxyCodeLine{168                 \textcolor{keywordflow}{if} ((merged\_summary-\/>tuple\_list[i].second.first + merged\_summary-\/>tuple\_list[j].second.first + merged\_summary-\/>tuple\_list[j].second.second) < capacity)\{}
\DoxyCodeLine{169                     merged\_summary-\/>tuple\_list[j].second.first += merged\_summary-\/>tuple\_list[i].second.first;}
\DoxyCodeLine{170 }
\DoxyCodeLine{171                     merged\_summary-\/>tuple\_list.erase(merged\_summary-\/>tuple\_list.begin() + i);}
\DoxyCodeLine{172                 \}}
\DoxyCodeLine{173             \} }
\DoxyCodeLine{174 }
\DoxyCodeLine{175 }
\DoxyCodeLine{176             \textcolor{keywordflow}{return} merged\_summary;}
\DoxyCodeLine{177         \}}

\end{DoxyCode}
\mbox{\Hypertarget{classqsbd_1_1gk_a34fd256cb9b567896c2dde66ce43f036}\label{classqsbd_1_1gk_a34fd256cb9b567896c2dde66ce43f036}} 
\index{qsbd::gk$<$ T $>$@{qsbd::gk$<$ T $>$}!query@{query}}
\index{query@{query}!qsbd::gk$<$ T $>$@{qsbd::gk$<$ T $>$}}
\doxysubsubsection{\texorpdfstring{query()}{query()}}
{\footnotesize\ttfamily template$<$class T $>$ \\
int \mbox{\hyperlink{classqsbd_1_1gk}{qsbd\+::gk}}$<$ T $>$\+::query (\begin{DoxyParamCaption}\item[{T}]{value }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



A method that returns the rank for some element {\ttfamily value}. 


\begin{DoxyParams}{Parameters}
{\em value} & The element to be queried \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The rank for such element 
\end{DoxyReturn}


Reimplemented from \mbox{\hyperlink{classqsbd_1_1quantile__sketch_a8cf64d79f25d910d1c1aed209ddac71e}{qsbd\+::quantile\+\_\+sketch$<$ T $>$}}.



Definition at line 257 of file gk.\+hpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{257                                     \{}
\DoxyCodeLine{258             \textcolor{keywordtype}{int} weight\_sum = 0;}
\DoxyCodeLine{259             \textcolor{keywordtype}{int} index = 0;}
\DoxyCodeLine{260 }
\DoxyCodeLine{261             \textcolor{keywordflow}{while}(value >= tuple\_list[index].first)\{}
\DoxyCodeLine{262                 weight\_sum += tuple\_list[index].second.first;}
\DoxyCodeLine{263                 index++;}
\DoxyCodeLine{264             \}}
\DoxyCodeLine{265             }
\DoxyCodeLine{266             \textcolor{keywordflow}{return} (weight\_sum -\/ 1 + ((tuple\_list[index].second.first + tuple\_list[index].second.second) / 2));}
\DoxyCodeLine{267         \}}

\end{DoxyCode}
\mbox{\Hypertarget{classqsbd_1_1gk_a3a1041a9881bf5362a0fb1578022b3e3}\label{classqsbd_1_1gk_a3a1041a9881bf5362a0fb1578022b3e3}} 
\index{qsbd::gk$<$ T $>$@{qsbd::gk$<$ T $>$}!update@{update}}
\index{update@{update}!qsbd::gk$<$ T $>$@{qsbd::gk$<$ T $>$}}
\doxysubsubsection{\texorpdfstring{update()}{update()}}
{\footnotesize\ttfamily template$<$class T $>$ \\
void \mbox{\hyperlink{classqsbd_1_1gk}{qsbd\+::gk}}$<$ T $>$\+::update (\begin{DoxyParamCaption}\item[{T}]{value }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}



A method to update the summary. 


\begin{DoxyParams}{Parameters}
{\em value} & A object of type $<$T$>$ \\
\hline
\end{DoxyParams}


Reimplemented from \mbox{\hyperlink{classqsbd_1_1quantile__sketch_a0e7eefd81eec272e92b7cb989be33c6a}{qsbd\+::quantile\+\_\+sketch$<$ T $>$}}.



Definition at line 75 of file gk.\+hpp.


\begin{DoxyCode}{0}
\DoxyCodeLine{75                                       \{}
\DoxyCodeLine{76             N += 1;}
\DoxyCodeLine{77 }
\DoxyCodeLine{78             \textcolor{comment}{//find smallest i such x[i] > value}}
\DoxyCodeLine{79             \textcolor{keywordtype}{int} index = find\_smallest\_i(tuple\_list, value);}
\DoxyCodeLine{80 }
\DoxyCodeLine{81             \textcolor{keywordtype}{int} weight = tuple\_list[index].second.first;}
\DoxyCodeLine{82             \textcolor{keywordtype}{int} uncertainty = tuple\_list[index].second.second;}
\DoxyCodeLine{83             \textcolor{keywordtype}{int} capacity = (int) ceil(2.0 * epsilon * N);}
\DoxyCodeLine{84 }
\DoxyCodeLine{85             \textcolor{keywordflow}{if}((weight + uncertainty + 1) < capacity)\{}
\DoxyCodeLine{86                 tuple\_list[index].second.first += 1;}
\DoxyCodeLine{87             \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{88                 \textcolor{comment}{// see if this inserts in the i position}}
\DoxyCodeLine{89                 \mbox{\hyperlink{utils_8h_abd01b471b80c0ef69eb752347fdc662a}{insert\_sorted}}(tuple\_list, \{value, \{1, weight + uncertainty -\/ 1\}\});}
\DoxyCodeLine{90 }
\DoxyCodeLine{91                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0, j = 1; j < tuple\_list.size(); i++, j++)\{}
\DoxyCodeLine{92                     \textcolor{keywordflow}{if} ((tuple\_list[i].second.first + tuple\_list[j].second.first + tuple\_list[j].second.second) < capacity)\{}
\DoxyCodeLine{93                         tuple\_list[j].second.first += tuple\_list[i].second.first;}
\DoxyCodeLine{94 }
\DoxyCodeLine{95                         tuple\_list.erase(tuple\_list.begin() + i);}
\DoxyCodeLine{96 }
\DoxyCodeLine{97                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{98                     \}}
\DoxyCodeLine{99                 \} }
\DoxyCodeLine{100             \}}
\DoxyCodeLine{101             }
\DoxyCodeLine{102             \textcolor{keywordflow}{return};}
\DoxyCodeLine{103         \}}

\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
src/gk/\mbox{\hyperlink{gk_8hpp}{gk.\+hpp}}\end{DoxyCompactItemize}
